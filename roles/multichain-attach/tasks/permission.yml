---
- name: attach to multichain if not already
  block:
  - name: attach to blockchain {{ blockchainName }}
    command: "/usr/local/bin/multichaind {{ blockchainName }}@{{ hostvars['serviceProvider'].ansible_host }}:{{ networkPort }}"
    register: result
  rescue:
  - name: copy ssh key
    copy:
      src: ~/.ssh/id_rsa
      dest: /home/ansible/.ssh/
  - name: enable user
    command: "{{ result.stdout_lines[5] }},send,recieve,issue,create,mine"
    delegate_to: serviceProvider
    when: "'writers' in group_names"
  - name: enable user
    command: "{{ result.stdout_lines[5] }},send,recieve"
    delegate_to: serviceProvider
    when: "'readers' in group_names"
  when: cronResult.changed
